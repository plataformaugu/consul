<div>
  <%= label_tag "survey_item_#{@survey_item.id}[]", @survey_item.title %>
  <% if @survey_item.required %>
    <small>(Obligatorio)</small>
  <% end %>

  <% @survey_item.data.each do |choice| %>
    <%= label_tag nil, style: 'font-weight: normal' do %>
      <%= check_box_tag "survey_item_#{@survey_item.id}[]", choice, !answers.nil? && answers.include?(choice), disabled: is_disabled %>
      <%= choice %>
    <% end %>
  <% end %>
</div>

<script>
  $('input[name="survey_item_<%= @survey_item.id %>[]"]').on('change', function() {
    const checkedCount = $('input[name="survey_item_<%= @survey_item.id %>[]"]:checked').length;

    if (checkedCount >= 2) {
      $('input[name="survey_item_<%= @survey_item.id %>[]"]:not(:checked)').prop('disabled', true);
    } else {
      $('input[name="survey_item_<%= @survey_item.id %>[]"]').prop('disabled', false);
    }
  });
</script>
