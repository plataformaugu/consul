<% provide :title do %><%= t("devise_views.users.registrations.new.title") %><% end %>
<h2><%= t("devise_views.users.registrations.new.title") %></h2>

<%= render "devise/omniauth_form", action: "sign_up" %>

<%= form_for(resource, as: resource_name, url: registration_path(resource_name)) do |f| %>
  <%= render "shared/errors", resource: resource %>

  <div class="row">
    <%= f.hidden_field :use_redeemable_code %>
    <%= f.hidden_field :locale, value: I18n.locale %>
    <%= f.hidden_field :username %>
    <%= f.hidden_field :nationality %>
    <%= f.hidden_field :profession %>
    <%= f.hidden_field :civil_status %>
    <%= f.hidden_field :date_of_birth %>
    <%= f.hidden_field :lat %>
    <%= f.hidden_field :long %>
    <%= f.hidden_field :web_browser %>

    <%= hidden_field_tag 'sector' %>

    <div class="row">
      <div class="small-12 medium-6 column">
        <%= f.text_field :document_number, 
            maxlength: 10,
            label: 'RUT',
            readonly: true,
            required: true,
            class: 'custom-input'
        %>
      </div>

      <div class="small-12 medium-6 column">
        <%= f.text_field :first_name, 
            maxlength: 24,
            label: 'Nombre',
            readonly: true,
            required: true,
            class: 'custom-input'
        %>
      </div>
    </div>


    <div class="row">
      <div class="small-12 medium-6 column">
        <%= f.text_field :last_name, 
            maxlength: 24,
            label: 'Apellido paterno',
            readonly: true,
            required: true,
            class: 'custom-input'
        %>
      </div>

      <div class="small-12 medium-6 column">
        <%= f.text_field :maiden_name, 
            maxlength: 24,
            label: 'Apellido materno',
            readonly: true,
            class: 'custom-input'
        %>
      </div>
    </div>

    <div class="row">
      <div class="small-12 medium-6 column">
        <%= f.email_field :email,
          required: true,
          class: 'custom-input',
          placeholder: 'ejemplo@correo.com'
        %>
        <span class="error-input-message" id="email-exists-message">
          El email ya está registrado
        </span>
      </div>

      <div class="small-12 medium-6 column">
        <label for="email_verification">Validar email</label>
        <%= email_field_tag 'email_verification',
          nil,
          class: 'custom-input',
          required: true,
          onpaste: 'return false;',
          autocomplete: 'off',
          placeholder: 'Repite el email anterior'
        %>
        <span class="error-input-message" id="email-verification-message">
          El email no coincide
        </span>
      </div>
    </div>

    <div class="row">
      <div class="small-12 medium-6 column">
        <%= f.select :gender,
            [
              'Masculino',
              'Femenino',
              'Otro'
            ],
            {
              include_blank: 'Elija una opción',
              label: 'Género'
            },
            {
              class: 'custom-input',
              required: true
            }
        %>

        <%= f.text_field :gender,
          id: 'custom_gender',
          style: 'display: none;',
          class: 'custom-input',
          placeholder: 'Ingresa tu género',
          onkeydown: 'return /[a-zA-ZáéíóúÁÉÍÓÚ ]/i.test(event.key)',
          maxlength: 20,
          label: false
        %>
      </div>

      <div class="small-12 medium-6 column">
        <%= f.label :phone_number, 'Teléfono de contacto' %>
        <div class="input-group">
          <span style="height: 3rem; user-select: none; display: flex; align-items: center; color: black;">
            +56
          </span>
          <%= f.number_field :phone_number, 
              label: 'Teléfono de contacto',
              max: 999999999,
              min: 100000000,
              onpaste: 'return false;',
              required: true,
              class: 'custom-input',
              label: false,
              placeholder: '912345678'
          %>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="small-12 medium-6 column">
        <%= f.select :comuna,
            ['Las Condes'] + @comunas.sort,
            {
              include_blank: 'Elija una opción',
              label: 'Comuna'
            },
            {
              class: 'custom-input',
              required: true
            }
        %>
      </div>
      <div class="small-12 medium-6 column">
        <%= f.text_field :address, 
            maxlength: 24,
            label: 'Dirección',
            required: true,
            class: 'custom-input',
            placeholder: 'Ingresa por ej. APOQUINDO 3400 (Sin “Avenida” o “Av.”)',
            maxlength: 58
        %>
        <div id="alternative-address">
          <p class="help-text">
            No se ha encontrado tu dirección, por favor escribe abajo tu calle y número.
          </p>
          <label>Calle</label>
          <%= text_field_tag 'alt-street', nil, class: 'custom-input', placeholder: 'Ingresa por ej. APOQUINDO (Sin “Avenida” o “Av.”)' %>
          <label>Número</label>
          <%= number_field_tag 'alt-number', nil, class: 'custom-input', maxlength: 8 %>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="small-12 medium-6 column">
        <%= f.select :house_type,
            [
              'Casa',
              'Departamento',
              'Oficina'
            ],
            {
              include_blank: 'Elija una opción',
              label: 'Casa/Depto/Oficina'
            },
            {
              class: 'custom-input',
            }
        %>
      </div>

      <div class="small-12 medium-6 column">
        <%= f.text_field :house_reference, 
            maxlength: 128,
            label: 'Aclaratoria',
            class: 'custom-input',
            placeholder: 'Nro. Depto. | Nro. Casa | Otra aclaración del lugar'
        %>
      </div>
    </div>

    <div class="row">
      <div class="small-12 medium-12 column">
        <%= f.select :education,
            [
              'Enseñanza Básica',
              'Enseñanza Media',
              'Técnico Profesional',
              'Técnico Superior',
              'Profesional',
              'Postgrado'
            ],
            {
              include_blank: 'Elija una opción',
              label: 'Nivel Educacional'
            },
            {
              class: 'custom-input',
              required: true
            }
        %>
      </div>
    </div>

    <div class="row">
      <div class="small-12 medium-6 column">
        <%= f.number_field :children_amount, 
            min: 0,
            max: 20,
            label: 'Nº de Hijos',
            value: 0,
            required: true,
            class: 'custom-input'
        %>
      </div>

      <div class="small-12 medium-6 column">
        <%= f.number_field :pets_amount, 
            min: 0,
            max: 100,
            label: 'Nº de Mascotas',
            value: 0,
            required: true,
            class: 'custom-input'
        %>
      </div>
    </div>

    <div class="small-12 column">
      <%= f.check_box :terms_of_service,
        title: t("devise_views.users.registrations.new.terms_title"),
        label: t("devise_views.users.registrations.new.terms",
                 terms: link_to(t("devise_views.users.registrations.new.terms_link"), "/condiciones",
                                title: t("shared.target_blank"),
                                target: "_blank")
                ),
        required: true
      %>
    </div>

      <div class="small-12 text-center">
        <%= f.submit t("devise_views.users.registrations.new.submit"), class: "solid-button rounded-xl" %>
      </div>

      <div class="small-12 text-center mt-2">
        Si tienes problema al registrarte, por favor <a href="/help#contacto" target="_blank">contáctanos aquí</a>
      </div>
      
      <div class="small-12 text-center mt-2" style="font-size: 0.8em; font-style: italic;">
        * Aquí puedes llenar tus datos voluntariamente, con el fin de ser parte de Participa Las Condes. 
        Te dará la posibilidad de entrar a la página y participar en: Consultas Ciudadanas, Encuestas, 
        Propuestas Ciudadanas, Iniciativas Municipales, Debates y Presupuestos Participativos. 
        Recuerda que cada proceso está sujeto a sus respectivas bases.<br>
        * La Municipalidad de Las Condes protege los datos de carácter personal de los participantes del sitio web, 
        asegurando la confidencialidad de los mismos, y que bajo ninguna circunstancia transferirá o publicará dichos 
        datos a persona alguna, salvo que ello sea ordenado por un tribunal de justicia o autoridad administrativa, 
        de acuerdo a la legislación vigente o que el participante mismo lo autorice.
      </div>
    </div>
  </div>
<% end %>
