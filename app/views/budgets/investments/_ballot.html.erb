<% reason = investment.reason_for_not_being_ballotable_by(current_user, ballot) %>
<div class="js-participation supports ballot">
  <% if ballot.has_investment?(investment) %>

    <div class="remove supported">
      <p class="investment-project-amount" style="margin-bottom: 0;">
        <%= investment.formatted_price %>
      </p>
      <% if investment.should_show_ballots? %>
        <% if ballot.confirmed_at == nil %>
          <%= link_to t("budgets.ballots.show.remove"),
                      budget_ballot_line_path(id: investment.id,
                                              budget_id: investment.budget_id,
                                              investments_ids: investment_ids),
                      class: "button button-remove-support expanded",
                      method: :delete,
                      remote: true,
                      style: 'margin-top: 10px;' %>
        <% end %>
      <% end %>
    </div>

  <% else %>

    <div class="add in-favor">
      <p class="investment-project-amount" style="margin-bottom: 0;">
        <%= investment.formatted_price %>
      </p>
      <% if investment.should_show_ballots? %>
        <% if ballot.confirmed_at == nil %>
          <%= link_to t("budgets.investments.investment.add"),
                      reason.present? && !ballot.has_investment?(investment) ? nil :
                      budget_ballot_lines_path(investment_id: investment.id,
                                              budget_id: investment.budget_id,
                                              investments_ids: investment_ids),
                      class: "button button-support expanded",
                      title: t("budgets.investments.investment.support_title"),
                      method: :post,
                      remote: true,
                      style: 'margin-top: 10px;',
                      disabled: reason.present? && !ballot.has_investment?(investment)
                      %>
        <% end %>
      <% end %>
    </div>

  <% end %>

</div>
