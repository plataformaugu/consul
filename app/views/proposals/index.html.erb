<% provide :title do %><%= t("proposals.index.title") %><% end %>
<% content_for :header_addon do %>
<% end %>
<% content_for :canonical do %>
  <%= render "shared/canonical", href: proposals_url %>
<% end %>

<main>
  <% if [
          @search_terms,
          @advanced_search_terms,
          params[:retired].present?,
          params[:selected].present?
        ].any? %>
    <%= render "shared/section_header",
      name: "proposals",
      color: "#33cc9d",
      section_image: "/images/propuestas-image.svg",
      title: "Propuestas",
      title2: "e Ideas",
      description: "En esta secci칩n podr치s realizar propuestas con el objetivo de mejorar la Municipalidad y/o nuestra comunidad. Para publicar tus ideas debes completar un formulario sencillo que permite adjuntar documentos relevantes."
    %>
    <div class="search-results-summary">
      <div class="row">
        <div class="small-12 column">
          <% if @search_terms || @advanced_search_terms %>
            <h2><%= t("shared.search_results") %></h2>
            <p>
              <%= page_entries_info @proposals %>
              <% if !@advanced_search_terms %>
                <%= sanitize(
                  t("proposals.index.search_results", count: @proposals.size, search_term: @search_terms)
                ) %>
              <% end %>
            <p>
          <% elsif params[:retired].present? %>
            <h2><%= t("proposals.index.retired_proposals") %></h2>
          <% elsif params[:selected].present? %>
            <h2><%= t("proposals.index.selected_proposals") %></h2>
          <% end %>
        </div>
      </div>
    </div>
  <% else %>
    <%= render "shared/section_header",
      color: "#33cc9d",
      section_image: "/images/propuestas-image.svg",
      title: "Propuestas",
      title2: "Ciudadanas",
      description: "En esta secci칩n podr치s realizar propuestas con el objetivo de mejorar la Municipalidad y/o nuestra comunidad. Para publicar tus ideas debes completar un formulario sencillo que permite adjuntar documentos relevantes."
    %>  
  <% end %>

  <div class="section-header-container">
    <a href="<%= new_proposal_path %>" title="<%= t("proposals.index.start_proposal") %>" data-turbolinks="false" class="create-button">
      <%= t("proposals.index.start_proposal") %>
    </a>
    <div class="search-container">
      <%= render "shared/search_form",
        search_path: proposals_path(page: 1),
        i18n_namespace: "proposals.index.search_form"
      %>
    </div>
  </div>
  <div class="row">
    <div id="proposals" class="proposals-list small-12 medium-9 column">

      <%= render Shared::AdvancedSearchComponent.new %>
      <%= render Shared::BannerComponent.new("proposals") %>

      <div class="proposals-subtitle">
        <h2>Revisa las ideas propuestas por los vecinos de la comuna</h2>
      </div>

      <div class="custom-cards-container">
        <div class="custom-cards">
          <% if @proposals.any? || current_user.blank? %>
            <%= render partial: "proposals/proposal", collection: @proposals %>
          <% else %>
            <%= empty_recommended_proposals_message_text(current_user) %>
          <% end %>
        </div>
      </div>
      <%= paginate @proposals %>
    </div>
  </div>
  <div class="general-footer-container">
      <%= render 'shared/waves_footer', color1: '#16664d', color2: '#33cc9d' do %>
      <% end %>
  </div>
</main>
